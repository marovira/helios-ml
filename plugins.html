<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API Reference" href="autoapi/index.html" /><link rel="prev" title="Quick Reference" href="quick-ref.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Plug-Ins - Helios documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Helios  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logo-transparent.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Training a Classifier with Helios</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick-ref.html">Quick Reference</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Plug-Ins</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="autoapi/helios/index.html">helios</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of helios</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="autoapi/helios/chkpt_migrator/index.html">helios.chkpt_migrator</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/core/index.html">helios.core</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of helios.core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/core/cuda/index.html">helios.core.cuda</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/core/distributed/index.html">helios.core.distributed</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/core/logging/index.html">helios.core.logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/core/rng/index.html">helios.core.rng</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/core/utils/index.html">helios.core.utils</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/data/index.html">helios.data</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of helios.data</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/data/datamodule/index.html">helios.data.datamodule</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/data/functional/index.html">helios.data.functional</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/data/samplers/index.html">helios.data.samplers</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/data/transforms/index.html">helios.data.transforms</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/losses/index.html">helios.losses</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of helios.losses</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/losses/utils/index.html">helios.losses.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/losses/weighted_loss/index.html">helios.losses.weighted_loss</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/metrics/index.html">helios.metrics</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of helios.metrics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/metrics/functional/index.html">helios.metrics.functional</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/metrics/metrics/index.html">helios.metrics.metrics</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/model/index.html">helios.model</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of helios.model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/model/model/index.html">helios.model.model</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/model/utils/index.html">helios.model.utils</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/nn/index.html">helios.nn</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of helios.nn</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/helios/nn/layers/index.html">helios.nn.layers</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of helios.nn.layers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/helios/nn/layers/pool/index.html">helios.nn.layers.pool</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/nn/swa_utils/index.html">helios.nn.swa_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/nn/utils/index.html">helios.nn.utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/helios/onnx/index.html">helios.onnx</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/optim/index.html">helios.optim</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of helios.optim</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/optim/utils/index.html">helios.optim.utils</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/plugins/index.html">helios.plugins</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of helios.plugins</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/plugins/optuna/index.html">helios.plugins.optuna</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/plugins/plugin/index.html">helios.plugins.plugin</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/helios/scheduler/index.html">helios.scheduler</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of helios.scheduler</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/scheduler/schedulers/index.html">helios.scheduler.schedulers</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/helios/scheduler/utils/index.html">helios.scheduler.utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/helios/trainer/index.html">helios.trainer</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/plugins.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="plug-ins">
<h1>Plug-Ins<a class="headerlink" href="#plug-ins" title="Link to this heading">¶</a></h1>
<section id="plug-in-api">
<h2>Plug-in API<a class="headerlink" href="#plug-in-api" title="Link to this heading">¶</a></h2>
<p>Helios offers a plug-in system that allows users to override certain elements of the
training loops. All plug-ins <em>must</em> derive from the main
<a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.Plugin" title="helios.plugins.plugin.Plugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Plugin</span></code></a> interface. The list of functions that are
available is similar to the ones offered by the <a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model" title="helios.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>
class and follow the same call order. For example, the training loop would look something
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plugin</span><span class="o">.</span><span class="n">on_training_start</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">on_training_start</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
     <span class="n">model</span><span class="o">.</span><span class="n">on_training_epoch_start</span><span class="p">()</span>

     <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
         <span class="n">plugin</span><span class="o">.</span><span class="n">process_training_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
         <span class="n">model</span><span class="o">.</span><span class="n">on_training_batch_start</span><span class="p">()</span>
         <span class="n">model</span><span class="o">.</span><span class="n">train_step</span><span class="p">()</span>
         <span class="n">model</span><span class="o">.</span><span class="n">on_training_batch_end</span><span class="p">()</span>

     <span class="n">model</span><span class="o">.</span><span class="n">on_training_epoch_end</span><span class="p">()</span>
<span class="n">plugin</span><span class="o">.</span><span class="n">on_training_end</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">on_training_end</span><span class="p">()</span>
</pre></div>
</div>
<p>Notice that the plug-in functions are always called <em>before</em> the corresponding model
functions. This is to allow the plug-ins to override the model if necessary or to set
state that can be later accessed by the model. The model (and the dataloader) can access
the plug-ins through the reference to the trainer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">train_step</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
   <span class="n">model</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">plugins</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">]</span> <span class="c1"># &lt;- Access plug-in with name &quot;foo&quot;</span>
</pre></div>
</div>
<section id="batch-processing">
<h3>Batch Processing<a class="headerlink" href="#batch-processing" title="Link to this heading">¶</a></h3>
<p>The major difference between the functions of the model and the plug-ins is the lack of a
<a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.train_step" title="helios.model.model.Model.train_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train_step()</span></code></a> function (and similarly for validation and
testing). Instead, the plug-ins have 3 equivalent functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.Plugin.process_training_batch" title="helios.plugins.plugin.Plugin.process_training_batch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_training_batch()</span></code></a></p></li>
<li><p><a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.Plugin.process_validation_batch" title="helios.plugins.plugin.Plugin.process_validation_batch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_validation_batch()</span></code></a></p></li>
<li><p><a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.Plugin.process_testing_batch" title="helios.plugins.plugin.Plugin.process_testing_batch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_testing_batch()</span></code></a></p></li>
</ul>
<p>These functions receive the batch as an argument and return the processed batch. They can
be used for a variety of tasks such as moving tensors to a given device, filtering batch
entries, converting values, etc. For example, suppose we wanted to reduce the training
batch size by removing elements. We could do this as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">process_training_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">batch</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># &lt;- Take the first two elements of the batch.</span>
</pre></div>
</div>
<p>When the model’s <a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.train_step" title="helios.model.model.Model.train_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train_step()</span></code></a> function is called, it
will only receive the first 2 tensors of the original batch.</p>
</section>
<section id="plug-in-registration">
<h3>Plug-in Registration<a class="headerlink" href="#plug-in-registration" title="Link to this heading">¶</a></h3>
<p>The trainer contains the <a class="reference internal" href="autoapi/helios/trainer/index.html#helios.trainer.Trainer.plugins" title="helios.trainer.Trainer.plugins"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plugins</span></code></a> table in which all
plug-ins must be registered. To facilitate this, the plug-in base class requires a string
to act as the key with which it will be added to the table. In addition, it provides a
function that automatically registers the plug-in itself into the plug-in table. The
function can be easily invoked from the
<a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.Plugin.configure_trainer" title="helios.plugins.plugin.Plugin.configure_trainer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure_trainer()</span></code></a> function as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">helios.plugins</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">helios.trainer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlt</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyPlugin</span><span class="p">(</span><span class="n">hlp</span><span class="o">.</span><span class="n">Plugin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;my_plugin&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure_trainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">hlt</span><span class="o">.</span><span class="n">Trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_in_trainer</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span> <span class="c1"># &lt;- Automatically registers the plug-in.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All plug-ins that are shipped with Helios contain a <code class="docutils literal notranslate"><span class="pre">plugin_id</span></code> field as a class
variable that can be used to easily access them from the trainer table. You are
<em>encouraged</em> to always use this instead of manually typing in the key. For example,
with the <a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.CUDAPlugin" title="helios.plugins.plugin.CUDAPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUDAPlugin</span></code></a>, you could access it like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">helios.plugins</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">helios.trainer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlt</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">hlt</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">plugin</span> <span class="o">=</span> <span class="n">hlp</span><span class="o">.</span><span class="n">CUDAPlugin</span><span class="p">()</span>
<span class="n">plugin</span><span class="o">.</span><span class="n">configure_trainer</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">plugins</span><span class="p">[</span><span class="n">hlp</span><span class="o">.</span><span class="n">CUDAPlugin</span><span class="o">.</span><span class="n">plugin_id</span><span class="p">]</span> <span class="c1"># &lt;- Access the plug-in like this.</span>
</pre></div>
</div>
</div>
</section>
<section id="unique-traits">
<h3>Unique Traits<a class="headerlink" href="#unique-traits" title="Link to this heading">¶</a></h3>
<p>In order to avoid conflicts, the plug-in API designates certain functions as <em>unique</em>. In
this context, a plug-in with a <em>unique</em> override may only appear exactly <em>once</em> in the
<a class="reference internal" href="autoapi/helios/trainer/index.html#helios.trainer.Trainer.plugins" title="helios.trainer.Trainer.plugins"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plugins</span></code></a> table from the trainer. If a second plug-in
with that specific override is added, an exception is raised. The full list of overrides
can be found in the <a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.UniquePluginOverrides" title="helios.plugins.plugin.UniquePluginOverrides"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniquePluginOverrides</span></code></a> struct. Each
plug-in has a copy found under <a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.Plugin.unique_overrides" title="helios.plugins.plugin.Plugin.unique_overrides"><code class="xref py py-attr docutils literal notranslate"><span class="pre">unique_overrides</span></code></a>
and <em>must</em> be filled in with the corresponding information for each plug-in.</p>
<p>For example, suppose we want to build a new plug-in that can modify the training batch and
cause training to stop early. We would then set the structure as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">helios.plugins</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlp</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyPlugin</span><span class="p">(</span><span class="n">hlp</span><span class="o">.</span><span class="n">Plugin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;my_plugin&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unique_overrides</span><span class="o">.</span><span class="n">training_batch</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique_overrides</span><span class="o">.</span><span class="n">should_training_stop</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_training_batch</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_training_stop</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Attempting to add two plug-ins with the same overrides <strong>will</strong> result in an exception
being raised.</p>
</div>
</section>
</section>
<section id="built-in-plug-ins">
<h2>Built-in Plug-ins<a class="headerlink" href="#built-in-plug-ins" title="Link to this heading">¶</a></h2>
<p>Helios ships with the following built-in plug-ins, which will be discussed in the
following sections:</p>
<ul class="simple">
<li><p><a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.CUDAPlugin" title="helios.plugins.plugin.CUDAPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUDAPlugin</span></code></a></p></li>
<li><p><a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.OptunaPlugin" title="helios.plugins.optuna.OptunaPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptunaPlugin</span></code></a></p></li>
</ul>
<section id="cuda-plug-in">
<h3>CUDA Plug-in<a class="headerlink" href="#cuda-plug-in" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.CUDAPlugin" title="helios.plugins.plugin.CUDAPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUDAPlugin</span></code></a> is designed to move tensors from the
batches returned by the datasets to the current CUDA device. The device is determined by
the trainer when training starts with the same logic used to assign the device to the
model. Specifically:</p>
<ul class="simple">
<li><p>If training isn’t distributed, the device is the GPU that is used for training.</p></li>
<li><p>If training is distributed, then the device corresponds to the GPU assigned to the given
process (i.e. the local rank).</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As its name implies, the <a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.CUDAPlugin" title="helios.plugins.plugin.CUDAPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUDAPlugin</span></code></a> <strong>requires</strong>
CUDA to be enabled to function. If it isn’t, an exception is raised.</p>
</div>
<p>The plug-in is designed to handle the following types of batches:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>,</p></li>
<li><p>Lists of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>,</p></li>
<li><p>Tuples of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, and</p></li>
<li><p>Dictionaries whose values are <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The contents of the containers need not be homogeneous. In other words, it is perfectly
valid some entries in a dictionary to <em>not</em> be tensors. The plug-in will automatically
recognise tensors and move them to the device.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The plug-in is <strong>not</strong> designed to handle nested containers. For instance, if your
batch is a dictionary containing arrays of tensors, then the plug-in will <strong>not</strong>
recognise the tensors contained in the arrays and move them.</p>
</div>
<p>In the event that your batch requires special handling, you can easily derive the class
and override the function that moves the tensors to the device. For example, suppose that
our batch consists of a dictionary of arrays of tensors. Then we would do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">helios.plugins</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyCUDAPlugin</span><span class="p">(</span><span class="n">hlp</span><span class="o">.</span><span class="n">CUDAPlugin</span><span class="p">):</span>
    <span class="c1"># Only need to override this function. Everything else will work automatically.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_move_collection_to_device</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)):</span>
                <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="n">batch</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">batch</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.CUDAPlugin" title="helios.plugins.plugin.CUDAPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">CUDAPlugin</span></code></a> is automatically registered in the
plug-in registry and can therefore be created through the
<a class="reference internal" href="autoapi/helios/plugins/plugin/index.html#helios.plugins.plugin.create_plugin" title="helios.plugins.plugin.create_plugin"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_plugin()</span></code></a> function.</p>
</div>
</section>
<section id="optuna-plug-in">
<h3>Optuna Plug-in<a class="headerlink" href="#optuna-plug-in" title="Link to this heading">¶</a></h3>
<p>In order to use the Optuna plugin, we first need to install <a class="reference external" href="https://optuna.readthedocs.io/en/stable/">optuna</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">optuna</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Optuna is a <strong>required</strong> dependency for this plug-in. If it isn’t installed, an
exception is raised.</p>
</div>
<p>The plug-in will automatically integrate with Optuna for hyper-parameter optimisation by
performing the following tasks:</p>
<ul class="simple">
<li><p>Register the <code class="docutils literal notranslate"><span class="pre">optuna.TrialPruned</span></code> exception type with the trainer for correct trial
pruning.</p></li>
<li><p>Automatically update the <a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model" title="helios.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> so the save name is
consistent and allow trials to continue if they’re interrupted.</p></li>
<li><p>Correctly handle reporting and pruning for regular and distributed training.</p></li>
</ul>
<p>A full example for how to use this plug-in can be found <a class="reference external" href="https://github.com/marovira/helios-ml/blob/master/examples/optuna_tutorial.py">here</a>, but we
will discuss the basics below. For the sake of simplicity, the code is identical to the
<a class="reference external" href="https://github.com/marovira/helios-ml/blob/master/examples/classifier_tutorial.py">cifar10</a>
example, so we will only focus on the necessary code to use the plug-in.</p>
<section id="id1">
<h4>Plug-in Registration<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p>After the creation of the <a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model" title="helios.model.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>,
<a class="reference internal" href="autoapi/helios/data/datamodule/index.html#helios.data.datamodule.DataModule" title="helios.data.datamodule.DataModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataModule</span></code></a>, and the
<a class="reference internal" href="autoapi/helios/trainer/index.html#helios.trainer.Trainer" title="helios.trainer.Trainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></a>, we can create the plug-in and do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">helios.plugins.optuna</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hlpo</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">optuna</span>
</pre></div>
</div>
<dl>
<dt>def objective(trial: optuna.Trial) -&gt; float:</dt><dd><p>model = …
datamodule = …
trainer = …</p>
<p>plugin = hlpo.OptunaPlugin(trial, “accuracy”)
plugin.configure_trainer(trainer)
plugin.configure_model(model)</p>
</dd>
</dl>
<p>The two <code class="docutils literal notranslate"><span class="pre">configure_</span></code> functions will do the following:</p>
<ol class="arabic simple">
<li><p>Configure the trainer so the plug-in is registered into the plug-in table and ensure
that <code class="docutils literal notranslate"><span class="pre">optuna.TrialPruned</span></code> is registered as a valid exception.</p></li>
<li><p>Configure the name of the model to allow cancelled trials to continue. Specifically, it
will append <code class="docutils literal notranslate"><span class="pre">_trial-&lt;trial-numer&gt;</span></code> to the model name.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The call to <a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.OptunaPlugin.configure_model" title="helios.plugins.optuna.OptunaPlugin.configure_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configure_model()</span></code></a> is
completely optional and only impacts the ability to resume trials. You may choose to
handle this yourself if it makes sense for your use-case.</p>
</div>
</section>
<section id="using-the-trial">
<h4>Using the Trial<a class="headerlink" href="#using-the-trial" title="Link to this heading">¶</a></h4>
<p>The trial instance is held by the plugin and can be easily accessed through the trainer.
For example, we can use it to configure the layers in the classifier network within the
<a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.setup" title="helios.model.model.Model.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a> function like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fast_init</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">plugin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">plugins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">OptunaPlugin</span><span class="p">)</span>

    <span class="c1"># Assign the tunable parameters so we can log them as hyper-parameters when</span>
    <span class="c1"># training ends.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tune_params</span><span class="p">[</span><span class="s2">&quot;l1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span>
        <span class="s2">&quot;l1&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tune_params</span><span class="p">[</span><span class="s2">&quot;l2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span>
        <span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tune_params</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;lr&quot;</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span>
        <span class="n">l1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tune_params</span><span class="p">[</span><span class="s2">&quot;l1&quot;</span><span class="p">],</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="n">l2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tune_params</span><span class="p">[</span><span class="s2">&quot;l2&quot;</span><span class="p">],</span>  <span class="c1"># type: ignore[arg-type]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="reporting-metrics">
<h4>Reporting Metrics<a class="headerlink" href="#reporting-metrics" title="Link to this heading">¶</a></h4>
<p>In order to allow the model to compute the metrics whenever it fits best within the
training workflow, the plug-in does <em>not</em> automatically report metrics to the trial. As a
result, it is the responsibility of the model to call
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_metrics()</span></code> whenever the metrics are
ready. In order for the plug-in to correctly report the metrics, the plug-in relies on the
following things:</p>
<ol class="arabic simple">
<li><p>The <a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.metrics" title="helios.model.model.Model.metrics"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metrics</span></code></a> table and</p></li>
<li><p>The value of <code class="docutils literal notranslate"><span class="pre">metric_name</span></code> in the constructor of
<a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.OptunaPlugin" title="helios.plugins.optuna.OptunaPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptunaPlugin</span></code></a>.</p></li>
</ol>
<p>In order for the plug-in to work properly, the plug-in assumes that the <code class="docutils literal notranslate"><span class="pre">metric_name</span></code>
key exists in the <a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.metrics" title="helios.model.model.Model.metrics"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metrics</span></code></a> table. If it doesn’t,
nothing is reported to the trial. The plug-in will automatically handled distributed
training correctly, so there’s no need for the model to do extra work.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In distributed training, it is your responsibility to ensure that the value of the
metric is correctly synced across processess (if applicable).</p>
</div>
<p>For example, we can report the metrics at the end of
<a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.on_validation_end" title="helios.model.model.Model.on_validation_end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">on_validation_end()</span></code></a> like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_validation_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validation_cycle</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
     <span class="o">...</span>
     <span class="n">plugin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">plugins</span><span class="p">[</span><span class="n">OptunaPlugin</span><span class="o">.</span><span class="n">plugin_id</span><span class="p">]</span>
     <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">OptunaPlugin</span><span class="p">)</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">report_metrics</span><span class="p">(</span><span class="n">validation_cycle</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="trial-pruning-and-returning-metrics">
<h4>Trial Pruning and Returning Metrics<a class="headerlink" href="#trial-pruning-and-returning-metrics" title="Link to this heading">¶</a></h4>
<p>The plug-in will automatically detect if a trial is pruned by optuna and gracefully
request that training end. The exact behaviour depends on whether training is distributed
or not. Specifically:</p>
<ul class="simple">
<li><p>If training is not distributed, then the plug-in will raise a
<code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.TrialPruned</span></code> exception <em>after</em> calling
<a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.on_training_end" title="helios.model.model.Model.on_training_end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">on_training_end()</span></code></a> on the model. This ensures that if
any metrics are logged when training ends, they get logged if the trial is pruned.</p></li>
<li><p>If training is distributed, then the plug-in requests that training terminate early. The
normal execution flow occurs when training is terminated early. Once the code exits the
<a class="reference internal" href="autoapi/helios/trainer/index.html#helios.trainer.Trainer.fit" title="helios.trainer.Trainer.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> function, the user should call
<a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.OptunaPlugin.check_pruned" title="helios.plugins.optuna.OptunaPlugin.check_pruned"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_pruned()</span></code></a> to ensure that the
corresponding exception is correctly raised.</p></li>
</ul>
<p>In code, this can be handled as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">Trial</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
     <span class="o">...</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">configure_trainer</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">configure_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
     <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">datamodule</span><span class="p">)</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">check_pruned</span><span class="p">()</span>
</pre></div>
</div>
<p>To correctly return metrics, there are two cases that need to be handled. If training
isn’t distributed, then the metrics can be grabbed directly from the
<a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.metrics" title="helios.model.model.Model.metrics"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metrics</span></code></a> table. If training is distributed, then the
model needs to do a bit more work to ensure things get synchronized correctly. For our
example, we will place the synchronization of the metrics on
<a class="reference internal" href="autoapi/helios/model/model/index.html#helios.model.model.Model.on_training_end" title="helios.model.model.Model.on_training_end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">on_training_end()</span></code></a>, but you may place it elsewhere if
it’s convenient for you:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">on_training_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="c1"># Push the metrics we want to save into the multi-processing queue.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_distributed</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span> <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_items</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()}</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="autoapi/helios/trainer/index.html#helios.trainer.Trainer.queue" title="helios.trainer.Trainer.queue"><code class="xref py py-attr docutils literal notranslate"><span class="pre">queue</span></code></a> ensures that the values get transferred to
the primary process. Once that’s done, we just need to add the following to our
<code class="docutils literal notranslate"><span class="pre">objective</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">Trial</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
     <span class="o">...</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">configure_trainer</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">configure_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
     <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">datamodule</span><span class="p">)</span>
     <span class="n">plugin</span><span class="o">.</span><span class="n">check_pruned</span><span class="p">()</span>

     <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">queue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span>

     <span class="n">metrics</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
     <span class="k">return</span> <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="generic-suggestion-of-parameters">
<h4>Generic Suggestion of Parameters<a class="headerlink" href="#generic-suggestion-of-parameters" title="Link to this heading">¶</a></h4>
<p>The plug-in comes equipped with a function that wraps the <code class="docutils literal notranslate"><span class="pre">suggest_</span></code> family of functions
from the <code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.Trial</span></code> instance it holds. This function is designed to allow
the suggestion of parameters to be controlled by an outside source (such as command line
arguments or a config file). The goal is to allow code re-usability by not having the
parameters be hard-coded. The function is called
<a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.OptunaPlugin.suggest" title="helios.plugins.optuna.OptunaPlugin.suggest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">suggest()</span></code></a> and can be used as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">Trial</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
     <span class="n">val1</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span><span class="s2">&quot;categorical&quot;</span><span class="p">,</span> <span class="s2">&quot;val1&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
     <span class="n">val2</span> <span class="o">=</span> <span class="n">plugin</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;val2&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The exact arguments for each <code class="docutils literal notranslate"><span class="pre">suggest_</span></code> function can be found <a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.trial.Trial.html#optuna.trial.Trial.suggest_categorical">here</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The plug-in does <em>not</em> provide wrappers for any function that is marked as deprecated.</p>
</div>
</section>
<section id="resuming-optuna-studies">
<h4>Resuming Optuna Studies<a class="headerlink" href="#resuming-optuna-studies" title="Link to this heading">¶</a></h4>
<p>Similar to the ability of the <a class="reference internal" href="autoapi/helios/trainer/index.html#helios.trainer.Trainer" title="helios.trainer.Trainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></a> to resume training in the
event of a failure or cancellation, Helios ships with a system to allow Optuna studies to
resume. The system is split into two halves: restoring the state of the samplers and
restoring trials that failed while preserving trials that completed. Let’s start by
looking at how we can recover samplers.</p>
<p>As per the official Optuna documentation, the recommended way of ensuring samplers are
reproducible is to:</p>
<ol class="arabic simple">
<li><p>Seed them,</p></li>
<li><p>Save them periodically to ensure they can be restored.</p></li>
</ol>
<p>Seeding of samplers is left to the user, though the use of
<a class="reference internal" href="autoapi/helios/core/rng/index.html#helios.core.rng.get_default_seed" title="helios.core.rng.get_default_seed"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_default_seed()</span></code></a> is recommended to ensure consistency. To
checkpoint the samplers, you can add do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">Trial</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
     <span class="n">checkpoint_sampler</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
<p>This will create a checkpoint stored in the folder specified by <code class="docutils literal notranslate"><span class="pre">root</span></code>. If the study
is stopped and you wish to restore the last checkpoint, you may do so like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In your setup code</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">restore_sampler</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.restore_sampler" title="helios.plugins.optuna.restore_sampler"><code class="xref py py-func docutils literal notranslate"><span class="pre">restore_sampler()</span></code></a> can return <code class="docutils literal notranslate"><span class="pre">None</span></code> if no
checkpoint is found, in which case you should construct the sampler manually.</p>
<p>To resume studies, you may use <a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.resume_study" title="helios.plugins.optuna.resume_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">resume_study()</span></code></a>. The
function can be used as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In your setup code</span>
<span class="n">study_args</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s2">&quot;study_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_study&quot;</span><span class="p">,</span>
     <span class="s2">&quot;storage&quot;</span><span class="p">:</span> <span class="s2">&quot;sqlite:///study.db&quot;</span><span class="p">,</span> <span class="c1"># &lt;- This is required</span>
     <span class="s2">&quot;load_if_exists&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">resume_study</span><span class="p">(</span><span class="n">study_args</span><span class="p">)</span>
</pre></div>
</div>
<p>The call to <a class="reference internal" href="autoapi/helios/plugins/optuna/index.html#helios.plugins.optuna.resume_study" title="helios.plugins.optuna.resume_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">resume_study()</span></code></a> will perform the following
operations:</p>
<ol class="arabic simple">
<li><p>It will create the study using the provided <code class="docutils literal notranslate"><span class="pre">study_args</span></code>. If the study contains no
previously run trials, it will return immediately.</p></li>
<li><p>If trials are found, then they are split into two groups: trials that completed (this
includes pruned trials) and trials that failed.</p></li>
<li><p>The old study will be backed up and a new one will be made. Trials that completed
successfully will be transferred over intact, whereas trials that failed will be
re-enqueued. Once this is done, the study is returned.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">study_args</span></code> dictionary <strong>must</strong> contain the <code class="docutils literal notranslate"><span class="pre">storage</span></code> key set to a path
beginning with <code class="docutils literal notranslate"><span class="pre">sqlite</span></code>. Likewise, <code class="docutils literal notranslate"><span class="pre">load_if_exists</span></code> <strong>must</strong> be set to true.</p>
</div>
<p>The function offers some points of control, mainly:</p>
<ul class="simple">
<li><p>A list of states to be considered as failures can be passed in to <code class="docutils literal notranslate"><span class="pre">failed_states</span></code>. By
default only <code class="docutils literal notranslate"><span class="pre">optuna.trial.TrialState.FAIL</span></code> is considered, but you may add additional
states such as <code class="docutils literal notranslate"><span class="pre">optuna.trial.TrialState.RUNNING</span></code> to handle cases where the study was
killed by an external source.</p></li>
<li><p>The function will automatically backup the storage of the study before creating the new
one as a fail-safe in the event that something goes wrong. If you don’t wish for a
backup to be made, you may set <code class="docutils literal notranslate"><span class="pre">backup_study</span></code> to false.</p></li>
</ul>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="autoapi/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="quick-ref.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Quick Reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Mauricio A. Rovira Galvez
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Plug-Ins</a><ul>
<li><a class="reference internal" href="#plug-in-api">Plug-in API</a><ul>
<li><a class="reference internal" href="#batch-processing">Batch Processing</a></li>
<li><a class="reference internal" href="#plug-in-registration">Plug-in Registration</a></li>
<li><a class="reference internal" href="#unique-traits">Unique Traits</a></li>
</ul>
</li>
<li><a class="reference internal" href="#built-in-plug-ins">Built-in Plug-ins</a><ul>
<li><a class="reference internal" href="#cuda-plug-in">CUDA Plug-in</a></li>
<li><a class="reference internal" href="#optuna-plug-in">Optuna Plug-in</a><ul>
<li><a class="reference internal" href="#id1">Plug-in Registration</a></li>
<li><a class="reference internal" href="#using-the-trial">Using the Trial</a></li>
<li><a class="reference internal" href="#reporting-metrics">Reporting Metrics</a></li>
<li><a class="reference internal" href="#trial-pruning-and-returning-metrics">Trial Pruning and Returning Metrics</a></li>
<li><a class="reference internal" href="#generic-suggestion-of-parameters">Generic Suggestion of Parameters</a></li>
<li><a class="reference internal" href="#resuming-optuna-studies">Resuming Optuna Studies</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>